<app-login (loginMade)="setKey($event)" (logoutMade)="removeKey()" [user]="user"></app-login>
<mat-card class="app-logo" >
    <img width="400" alt="Writing Swarm Logo" [src]="LOGO" />
</mat-card>
<mat-card class="app-main" *ngIf="user">
  <mat-card-header class="project-header">
    <mat-card-subtitle>Project:</mat-card-subtitle>
    <mat-card-title class="title" *ngIf="!editProject">{{topic}}
      <em (click)="editProject = true;" class="material-icons action" matTooltip="Change Project">edit</em>
    </mat-card-title>
    <mat-card-title *ngIf="editProject">
      <mat-form-field>
        <input matInput placeholder="Project name" type="text" [(ngModel)]="topic">
      </mat-form-field>
      <em *ngIf="editProject" (click)="changeProject()" class="material-icons action">save</em>
      <em *ngIf="editProject" (click)="cancelEditProject()" class="material-icons action">cancel</em>
    </mat-card-title>
<!--    <p class="project-hash">(Using hash {{ rootHash }})</p>-->
  </mat-card-header>

  <mat-drawer-container *ngIf="entries">

    <mat-drawer #fileDrawer mode="side" opened>
      <nav>
        <ul>
          <li *ngFor="let entry of entries" >
            <a href="#" (click)="loadPathContent(entry.path)" [ngClass]="{'itemSelected': currentPath==entry.path}">{{ entry.path }}</a>
          </li>
        </ul>
      </nav>
      <mat-divider></mat-divider>
      <nav>
        <ul>
          <li>
            <a href="#" (click)="openNewDialog()" >Add File...</a>
          </li>
        </ul>
      </nav>
    </mat-drawer>
    <mat-drawer-content>
      <div class="menu-toggler">
        <span (click)="fileDrawer.toggle()" class="action">
          <mat-icon *ngIf="fileDrawer.opened">menu_open</mat-icon>
          <mat-icon *ngIf="!fileDrawer.opened">menu</mat-icon>
        </span>
      </div>
      <app-writer id="content" *ngIf="content" [path]="currentPath" [content]="content" (contentChange)="saveContent($event)"></app-writer>
      <mat-card-content *ngIf="!content" class="no-file">
        Select a file from the list
      </mat-card-content>
    </mat-drawer-content>
  </mat-drawer-container>

  <mat-card-title *ngIf="!creating && !rootHash" class="spinner"><em class="fa fa-spinner fa-spin"></em>Loading feed...</mat-card-title>
  <mat-card-title *ngIf="creating" class="spinner"><em class="fa fa-spinner fa-spin"></em>Creating feed...</mat-card-title>
  <mat-card-title *ngIf="!creating && !entries && rootHash" class="spinner"><em class="fa fa-spinner fa-spin"></em>Loading content...</mat-card-title>
</mat-card>
<mat-card id="messager" *ngIf="user" style="flex: 1;display: flex;flex-direction: column;background: #fff;">
  <a (click)="sendMessage()">Send Message</a>

  <pre class="textzone">{{ messageReceived }}</pre>
</mat-card>
